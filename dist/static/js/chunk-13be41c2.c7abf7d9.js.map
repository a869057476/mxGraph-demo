{"version":3,"sources":["webpack:///./src/views/mxgraphEdit.vue?fe76","webpack:///./src/views/mxgraphEdit.vue?24a2","webpack:///src/views/mxgraphEdit.vue","webpack:///./src/views/mxgraphEdit.vue?1b7b","webpack:///./src/views/mxgraphEdit.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","on","save","_v","clear","ref","staticClass","staticRenderFns","name","data","model","graph","mounted","console","log","xml","json","tbContainer","style","position","overflow","padding","left","top","width","bottom","$refs","container","appendChild","toolbar","enabled","right","background","MxGraphModel","MxGraph","setConnectable","setMultigraph","vertex","setVertex","img","MxUtils","setOpacity","tmp","addVertex","doc","parseXml","codec","MxCodec","decode","documentElement","getModel","methods","addToolbarItem","stopEditing","geometry","x","y","addCell","setSelectionCell","funct","evt","cell","pt","MxEvent","addListener","consume","makeDraggable","localStorage","setItem","JSON","stringify","removeItem","removeCells","getChildVertices","getDefaultParent","component"],"mappings":"2IAAA,W,yCCAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,MAAM,CAACA,EAAG,SAAS,CAACE,MAAM,CAAC,MAAQ,GAAG,MAAQ,WAAWC,GAAG,CAAC,MAAQP,EAAIQ,OAAO,CAACR,EAAIS,GAAG,QAAQL,EAAG,SAAS,CAACE,MAAM,CAAC,MAAQ,GAAG,MAAQ,WAAWC,GAAG,CAAC,MAAQP,EAAIU,QAAQ,CAACV,EAAIS,GAAG,UAAUL,EAAG,MAAM,CAACO,IAAI,YAAYC,YAAY,wBAC3UC,EAAkB,G,YCWtB,iJACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IAEA,GACEC,KAAM,cACNC,KAFF,WAGI,MAAO,CACLC,MAAO,KACPC,MAAO,OAGXC,QARF,WAQA,WACA,yFACA,uBACIC,QAAQC,IAAIC,GACZF,QAAQC,IAAIE,GAEZH,QAAQC,IAAI,eAEZ,IAAJ,gCAEIG,EAAYC,MAAMC,SAAW,WAC7BF,EAAYC,MAAME,SAAW,SAC7BH,EAAYC,MAAMG,QAAU,MAC5BJ,EAAYC,MAAMI,KAAO,MACzBL,EAAYC,MAAMK,IAAM,MACxBN,EAAYC,MAAMM,MAAQ,OAC1BP,EAAYC,MAAMO,OAAS,MAC3B9B,KAAK+B,MAAMC,UAAUC,YAAYX,GAEjC,IAAJ,WAEIY,EAAQC,SAAU,EAElB,IAAJ,gCAEIH,EAAUT,MAAMC,SAAW,WAC3BQ,EAAUT,MAAME,SAAW,SAC3BO,EAAUT,MAAMI,KAAO,OACvBK,EAAUT,MAAMK,IAAM,MACtBI,EAAUT,MAAMa,MAAQ,MACxBJ,EAAUT,MAAMO,OAAS,MACzBE,EAAUT,MAAMc,WAAa,mCAC7BrC,KAAK+B,MAAMC,UAAUC,YAAYD,GACjChC,KAAKe,MAAQ,IAAIuB,EACjBtC,KAAKgB,MAAQ,IAAIuB,EAAQP,EAAWhC,KAAKe,OACzCf,KAAKgB,MAAMwB,gBAAe,GAC1BxC,KAAKgB,MAAMyB,eAAc,GAEzB,IAAJ,oBACM,IAAN,+BAEMC,EAAOC,WAAU,GACjB,IAAN,kCAEMC,EAAIT,SAAU,EACd,EAAN,2DACQ,IAAR,6BAEQU,EAAQC,WAAWF,EAAK,EAAhC,QACQA,EAAIT,QAAUY,MAIlBC,EAAU,iCAAkC,IAAK,GAAI,IACrDA,EAAU,+BAAgC,IAAK,GAAI,iBACnDA,EAAU,+BAAgC,GAAI,GAAI,iBAClDA,EAAU,+BAAgC,GAAI,GAAI,iBAClDA,EAAU,gCAAiC,GAAI,GAAI,kBACnDA,EAAU,gCAAiC,GAAI,GAAI,kBACnDA,EAAU,6BAA8B,GAAI,GAAI,eAEhD,IAAIC,EAAMJ,EAAQK,SAAS9B,GACvB+B,EAAQ,IAAIC,EAAQH,GACxBE,EAAME,OAAOJ,EAAIK,gBAAiBtD,KAAKgB,MAAMuC,aAE/CC,QAAS,CACPC,eADJ,SACA,SACM,IAAN,sBACQzC,EAAM0C,aAAY,GAClB,IAAR,4BAEQhB,EAAOiB,SAASC,EAAIA,EACpBlB,EAAOiB,SAASE,EAAIA,EAEpB7C,EAAM8C,QAAQpB,GACd1B,EAAM+C,iBAAiBrB,IAE/B,kCACQ,IAAR,iCAEQsB,EAAMhD,EAAOiD,EAAKC,EAAMC,EAAGP,EAAGO,EAAGN,MASnC,OANAO,EAAQC,YAAYzB,EAAK,aAAa,SAA5C,IAC4B,IAAhBA,EAAIT,SACNiC,EAAQE,QAAQL,MAGpBpB,EAAQ0B,cAAc3B,EAAK5B,EAAOgD,GAC3BpB,GAETrC,KA1BJ,WA2BM,IAAN,QACA,kCACA,cACA,uBACMiE,aAAaC,QAAQ,aAAcrD,GACnCoD,aAAaC,QAAQ,cAAeC,KAAKC,UAAUtD,IACnDH,QAAQC,IAAIC,GACZF,QAAQC,IAAIE,IAEdZ,MApCJ,WAqCM+D,aAAaI,WAAW,cACxBJ,aAAaI,WAAW,eACxB,IAAN,yFACA,uBACM1D,QAAQC,IAAIC,GACZF,QAAQC,IAAIE,GACZrB,KAAKgB,MAAM6D,YAAY7E,KAAKgB,MAAM8D,iBAAiB9E,KAAKgB,MAAM+D,wBC1IiR,I,wBCQjVC,EAAY,eACd,EACAlF,EACAc,GACA,EACA,KACA,WACA,MAIa,aAAAoE,E","file":"static/js/chunk-13be41c2.c7abf7d9.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./mxgraphEdit.vue?vue&type=style&index=0&id=3d571b10&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',[_c('button',{attrs:{\"small\":\"\",\"color\":\"primary\"},on:{\"click\":_vm.save}},[_vm._v(\"保存\")]),_c('button',{attrs:{\"small\":\"\",\"color\":\"primary\"},on:{\"click\":_vm.clear}},[_vm._v(\"清空\")])]),_c('div',{ref:\"container\",staticClass:\"custom-container\"})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div>\r\n      <button small color=\"primary\" @click=\"save\">保存</button>\r\n      <button small color=\"primary\" @click=\"clear\">清空</button>\r\n    </div>\r\n    <div ref=\"container\" class=\"custom-container\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport mxgraph from '@/utils/mxgraph'\r\nconst { mxGraph, mxGraphModel, mxUtils, mxCell, mxToolbar, mxGeometry, mxEvent, mxCodec } = mxgraph\r\nconst MxGraph = mxGraph\r\nconst MxGraphModel = mxGraphModel\r\nconst MxUtils = mxUtils\r\nconst MxCell = mxCell\r\nconst MxToolbar = mxToolbar\r\nconst MxGeometry = mxGeometry\r\nconst MxEvent = mxEvent\r\nconst MxCodec = mxCodec\r\n\r\nexport default {\r\n  name: 'MxgraphEdit',\r\n  data() {\r\n    return {\r\n      model: null,\r\n      graph: null\r\n    }\r\n  },\r\n  mounted() {\r\n    const json = localStorage.getItem('mxgraphjson') ? JSON.parse(localStorage.getItem('mxgraphjson')) : {}\r\n    const xml = this.$x2js.js2xml(json)\r\n    console.log(xml)\r\n    console.log(json)\r\n\r\n    console.log('MxgraphEdit')\r\n    // 创建一个div作为toolbar的容器\r\n    const tbContainer = document.createElement('div')\r\n\r\n    tbContainer.style.position = 'absolute'\r\n    tbContainer.style.overflow = 'hidden'\r\n    tbContainer.style.padding = '2px'\r\n    tbContainer.style.left = '0px'\r\n    tbContainer.style.top = '0px'\r\n    tbContainer.style.width = '24px'\r\n    tbContainer.style.bottom = '0px'\r\n    this.$refs.container.appendChild(tbContainer)\r\n    // 创建一个mxToolbar\r\n    const toolbar = new MxToolbar(tbContainer)\r\n\r\n    toolbar.enabled = false\r\n    // 创建一个div作为graph的容器\r\n    const container = document.createElement('div')\r\n\r\n    container.style.position = 'absolute'\r\n    container.style.overflow = 'hidden'\r\n    container.style.left = '24px'\r\n    container.style.top = '0px'\r\n    container.style.right = '0px'\r\n    container.style.bottom = '0px'\r\n    container.style.background = 'url(\"./mxgraph/images/grid.gif\")'\r\n    this.$refs.container.appendChild(container)\r\n    this.model = new MxGraphModel()\r\n    this.graph = new MxGraph(container, this.model)\r\n    this.graph.setConnectable(true)\r\n    this.graph.setMultigraph(false)\r\n\r\n    const addVertex = (icon, w, h, style) => {\r\n      const vertex = new MxCell(null, new MxGeometry(0, 0, w, h), style)\r\n\r\n      vertex.setVertex(true)\r\n      const img = this.addToolbarItem(this.graph, toolbar, vertex, icon)\r\n\r\n      img.enabled = true\r\n      this.graph.getSelectionModel().addListener(MxEvent.CHANGE, () => {\r\n        const tmp = this.graph.isSelectionEmpty()\r\n\r\n        MxUtils.setOpacity(img, (tmp) ? 100 : 20)\r\n        img.enabled = tmp\r\n      })\r\n    }\r\n\r\n    addVertex('./mxgraph/images/rectangle.gif', 100, 40, '')\r\n    addVertex('./mxgraph/images/rounded.gif', 100, 40, 'shape=rounded')\r\n    addVertex('./mxgraph/images/ellipse.gif', 40, 40, 'shape=ellipse')\r\n    addVertex('./mxgraph/images/rhombus.gif', 40, 40, 'shape=rhombus')\r\n    addVertex('./mxgraph/images/triangle.gif', 40, 40, 'shape=triangle')\r\n    addVertex('./mxgraph/images/cylinder.gif', 40, 40, 'shape=cylinder')\r\n    addVertex('./mxgraph/images/actor.gif', 30, 40, 'shape=actor')\r\n\r\n    var doc = MxUtils.parseXml(xml)\r\n    var codec = new MxCodec(doc)\r\n    codec.decode(doc.documentElement, this.graph.getModel())\r\n  },\r\n  methods: {\r\n    addToolbarItem(graph, toolbar, prototype, image) {\r\n      const funct = function(graph, evt, cell, x, y) {\r\n        graph.stopEditing(false)\r\n        const vertex = graph.getModel().cloneCell(prototype)\r\n\r\n        vertex.geometry.x = x\r\n        vertex.geometry.y = y\r\n\r\n        graph.addCell(vertex)\r\n        graph.setSelectionCell(vertex)\r\n      }\r\n      const img = toolbar.addMode(null, image, function(evt, cell) {\r\n        const pt = this.graph.getPointForEvent(evt)\r\n\r\n        funct(graph, evt, cell, pt.x, pt.y)\r\n      })\r\n\r\n      MxEvent.addListener(img, 'mousedown', function(evt) {\r\n        if (img.enabled === false) {\r\n          MxEvent.consume(evt)\r\n        }\r\n      })\r\n      MxUtils.makeDraggable(img, graph, funct)\r\n      return img\r\n    },\r\n    save() {\r\n      const codec = new MxCodec()\r\n      const encodedModel = codec.encode(this.graph.getModel())\r\n      const xml = mxUtils.getXml(encodedModel)\r\n      const json = this.$x2js.xml2js(xml)\r\n      localStorage.setItem('mxgraphxml', xml)\r\n      localStorage.setItem('mxgraphjson', JSON.stringify(json))\r\n      console.log(xml)\r\n      console.log(json)\r\n    },\r\n    clear() {\r\n      localStorage.removeItem('mxgraphxml')\r\n      localStorage.removeItem('mxgraphjson')\r\n      const json = localStorage.getItem('mxgraphjson') ? JSON.parse(localStorage.getItem('mxgraphjson')) : {}\r\n      const xml = this.$x2js.js2xml(json)\r\n      console.log(xml)\r\n      console.log(json)\r\n      this.graph.removeCells(this.graph.getChildVertices(this.graph.getDefaultParent()))\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.custom-container {\r\n  position: absolute;\r\n  height: 100%;\r\n  width: 100%;\r\n  background-color: #ffffff;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./mxgraphEdit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./mxgraphEdit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./mxgraphEdit.vue?vue&type=template&id=3d571b10&scoped=true&\"\nimport script from \"./mxgraphEdit.vue?vue&type=script&lang=js&\"\nexport * from \"./mxgraphEdit.vue?vue&type=script&lang=js&\"\nimport style0 from \"./mxgraphEdit.vue?vue&type=style&index=0&id=3d571b10&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3d571b10\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}